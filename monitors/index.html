
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cli/">
      
      
        <link rel="next" href="../data_model/">
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.1.6">
    
    
      
        <title>Cron Monitors - Task Badger Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.ded33207.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../assets/css/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  


  <script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-018PZFQ3EE"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-018PZFQ3EE",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-018PZFQ3EE",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>

  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#scheduled-task-monitors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Task Badger Documentation" class="md-header__button md-logo" aria-label="Task Badger Documentation" data-md-component="logo">
      
  <img src="../assets/logo_white.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Task Badger Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Cron Monitors
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Task Badger Documentation" class="md-nav__button md-logo" aria-label="Task Badger Documentation" data-md-component="logo">
      
  <img src="../assets/logo_white.png" alt="logo">

    </a>
    Task Badger Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Quick Start
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        Using the API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        Using the CLI
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Cron Monitors
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Cron Monitors
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-monitor" class="md-nav__link">
    Creating a monitor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interval-monitors" class="md-nav__link">
    Interval Monitors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cron-monitors" class="md-nav__link">
    Cron Monitors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    Set Up
  </a>
  
    <nav class="md-nav" aria-label="Set Up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-cli" class="md-nav__link">
    Using the CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-api" class="md-nav__link">
    Using the API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../data_model/" class="md-nav__link">
        Data Model
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        API Endpoints
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        Integrations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../python/" class="md-nav__link">
        Python SDK
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#creating-a-monitor" class="md-nav__link">
    Creating a monitor
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#interval-monitors" class="md-nav__link">
    Interval Monitors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cron-monitors" class="md-nav__link">
    Cron Monitors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#set-up" class="md-nav__link">
    Set Up
  </a>
  
    <nav class="md-nav" aria-label="Set Up">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#using-the-cli" class="md-nav__link">
    Using the CLI
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-the-api" class="md-nav__link">
    Using the API
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="scheduled-task-monitors">Scheduled Task Monitors</h1>
<p>A common need in task monitoring is being notified if a scheduled task fails or doesn't run.
It is easy to determine if tasks are successful using the task itself but detecting if a task fails or
does not run at all requires a separate system.</p>
<p>This is where Task Badger Monitors can help.</p>
<p>By registering a task with Task Badger you can be sure that if the task fails or takes too long
you will get notified.</p>
<p>But what if the task never runs at all and never gets registered with Task Badger? We've got you
covered there too. By telling Task Badger when you expect the task to run we can check and make
sure that it does actually run when it's supposed to.</p>
<h2 id="creating-a-monitor">Creating a monitor</h2>
<p>Monitors are created via the Task Badger web UI. When creating a monitor you will need to chose
between two types: "interval" and "cron".</p>
<h2 id="interval-monitors">Interval Monitors</h2>
<p>Use an interval monitor when your tasks are scheduled in a chain (one after the other) and not based
on real time.</p>
<p>For example, a task that runs every 5 minutes where each task is scheduled after the previous task
starts / ends.</p>
<h2 id="cron-monitors">Cron Monitors</h2>
<p>Use a cron monitor when you need more advanced scheduling or when your tasks are executed based on
real time, for example, once per hour, on the hour.</p>
<p>Cron monitor require writing cron schedule expressions. Cron expressions are split up in 5 fields
as follows:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a># ┌───────────── minute (0 - 59)
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a># │ ┌───────────── hour (0 - 23)
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a># │ │ ┌───────────── day of the month (1 - 31)
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a># │ │ │ ┌───────────── month (1 - 12)
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a># │ │ │ │ ┌───────────── day of the week (0 - 6) (Sunday to Saturday;
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a># │ │ │ │ │                                   7 is also Sunday on some systems)
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a># │ │ │ │ │
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a># │ │ │ │ │
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a># * * * * *
</code></pre></div>
<p>Here are some examples:</p>
<table>
<thead>
<tr>
<th>Expression</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>1 0 * * *</code></td>
<td>Daily at 1 minute past midnight</td>
</tr>
<tr>
<td><code>0 */2 * * *</code></td>
<td>Every 2nd hour</td>
</tr>
<tr>
<td><code>45 23 * * 6</code></td>
<td>23:45 every Saturday (day 6)</td>
</tr>
</tbody>
</table>
<p>For a more detailed explanation see <a href="https://en.wikipedia.org/wiki/Cron#Overview">Wikipedia</a>.</p>
<h2 id="set-up">Set Up</h2>
<p>Once you have created a monitor you need to configure your tasks to notify Task Badger when they
run.</p>
<h3 id="using-the-cli">Using the CLI</h3>
<p>The CLI provides an easy way to monitor your tasks. To associate a task with a monitor simply
provide the monitor ID:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>$<span class="w"> </span>taskbadger<span class="w"> </span>run<span class="w"> </span><span class="s2">&quot;run script&quot;</span><span class="w"> </span>--monitor-id<span class="o">=</span>XYZ<span class="w"> </span>--<span class="w"> </span>path/to/script.sh
</code></pre></div>
<h3 id="using-the-api">Using the API</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Python</label><label for="__tabbed_1_2">Shell</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span> <span class="nn">taskbadger</span> <span class="kn">import</span> <span class="n">Task</span><span class="p">,</span> <span class="n">StatusEnum</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">name</span><span class="s2">&quot;my-task&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="n">StatsuEnum</span><span class="o">.</span><span class="n">processing</span><span class="p">,</span> <span class="n">monitor_id</span><span class="o">=</span><span class="s2">&quot;XYZ&quot;</span><span class="p">)</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">try</span><span class="p">:</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="c1"># Execute your task here...</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    <span class="n">task</span><span class="o">.</span><span class="n">error</span><span class="p">({</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>        <span class="s2">&quot;exception&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a>    <span class="p">})</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a>    <span class="n">task</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">status</span><span class="o">=</span><span class="n">StatusEnum</span><span class="o">.</span><span class="n">success</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Using the API directly you can pass the monitor ID vai the <code>X-TASKBADGER-MONITOR</code>
header. The monitor ID only needs to be included in the request to create the task.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span><span class="s2">&quot;https://taskbadger.net/api/</span><span class="si">${</span><span class="nv">ORG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">/tasks/&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="si">${</span><span class="nv">API_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="hll"><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;X-TASKBADGER-MONITOR: %{MONITOR_ID}&quot;</span><span class="w"> </span><span class="se">\</span>
</span><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;name&quot;: &quot;demo task&quot;, &quot;status&quot;: &quot;processing&quot;}&#39;</span>
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="c1"># Response { &quot;id&quot;: &quot;128aoa98e0fiq238&quot; ...}</span>
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a><span class="c1"># Execute your scheduled task here...</span>
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>curl<span class="w"> </span>-X<span class="w"> </span>PATCH<span class="w"> </span><span class="s2">&quot;https://taskbadger.net/api/</span><span class="si">${</span><span class="nv">ORG</span><span class="si">}</span><span class="s2">/</span><span class="si">${</span><span class="nv">PROJECT</span><span class="si">}</span><span class="s2">/tasks/128aoa98e0fiq238/&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="si">${</span><span class="nv">API_KEY</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a><span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Content-Type: application/json&quot;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a><span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;status&quot;: &quot;success&quot;}&#39;</span><span class="w">    </span>
</code></pre></div>
</div>
</div>
</div>


  




                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "content.code.annotate", "content.tabs.link"], "search": "../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.51198bba.min.js"></script>
      
    
  </body>
</html>